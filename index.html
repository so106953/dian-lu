import React, { useState } from ‘react’;
import { Calculator } from ‘lucide-react’;

export default function CircuitCalculator() {
const [mode, setMode] = useState(‘basic’);
const [voltage, setVoltage] = useState(’’);
const [current, setCurrent] = useState(’’);
const [powerFactor, setPowerFactor] = useState(’’);
const [frequency, setFrequency] = useState(‘50’);
const [result, setResult] = useState(null);

// 串联电阻
const [seriesResistors, setSeriesResistors] = useState([’’, ‘’]);

// 并联电阻
const [parallelResistors, setParallelResistors] = useState([’’, ‘’]);

// 混合电路
const [mixedResistors, setMixedResistors] = useState([’’, ‘’]);

const calculate = () => {
if (mode === ‘basic’) {
const V = parseFloat(voltage);
const I = parseFloat(current);
const cosφ = parseFloat(powerFactor);
const f = parseFloat(frequency);

```
  if (!V || !I) {
    alert('请输入电压和电流值');
    return;
  }
  
  // 计算阻抗 Z = V / I
  const impedance = V / I;
  
  // 如果有功率因数，计算电阻和电抗
  let resistance, reactance, inductance;
  
  if (cosφ && cosφ >= 0 && cosφ <= 1) {
    // 电阻 R = Z * cosφ
    resistance = impedance * cosφ;
    // 电抗 X = Z * sinφ
    reactance = impedance * Math.sin(Math.acos(cosφ));
  } else {
    // 如果没有功率因数，假设纯阻性负载
    resistance = impedance;
    reactance = 0;
  }
  
  // 计算电感 L = X / (2πf)，单位转换为 mH
  if (f && f > 0 && reactance > 0) {
    inductance = (reactance / (2 * Math.PI * f)) * 1000; // 转换为 mH
  } else {
    inductance = 0;
  }
  
  setResult({
    inductance: inductance.toFixed(2),
    resistance: resistance.toFixed(2),
    impedance: impedance.toFixed(2),
    reactance: reactance.toFixed(2)
  });
} else if (mode === 'series') {
  const resistors = seriesResistors
    .filter(r => r !== '')
    .map(r => parseFloat(r))
    .filter(r => !isNaN(r));
  
  if (resistors.length === 0) {
    alert('请至少输入一个电阻值');
    return;
  }
  
  const totalResistance = resistors.reduce((sum, r) => sum + r, 0);
  setResult({
    totalResistance: totalResistance.toFixed(2),
    count: resistors.length,
    resistors: resistors
  });
} else if (mode === 'parallel') {
  const resistors = parallelResistors
    .filter(r => r !== '')
    .map(r => parseFloat(r))
    .filter(r => !isNaN(r) && r > 0);
  
  if (resistors.length === 0) {
    alert('请至少输入一个电阻值');
    return;
  }
  
  const totalResistance = 1 / resistors.reduce((sum, r) => sum + (1/r), 0);
  setResult({
    totalResistance: totalResistance.toFixed(2),
    count: resistors.length,
    resistors: resistors
  });
} else if (mode === 'mixed') {
  const resistors = mixedResistors
    .filter(r => r !== '')
    .map(r => parseFloat(r))
    .filter(r => !isNaN(r) && r > 0);
  
  if (resistors.length === 0) {
    alert('请至少输入电阻值');
    return;
  }
  
  // 简单示例：前一半串联，后一半并联
  const half = Math.floor(resistors.length / 2);
  const series = resistors.slice(0, half);
  const parallel = resistors.slice(half);
  
  const seriesTotal = series.reduce((sum, r) => sum + r, 0);
  const parallelTotal = parallel.length > 0 
    ? 1 / parallel.reduce((sum, r) => sum + (1/r), 0)
    : 0;
  
  const totalResistance = seriesTotal + parallelTotal;
  setResult({
    totalResistance: totalResistance.toFixed(2),
    seriesTotal: seriesTotal.toFixed(2),
    parallelTotal: parallelTotal.toFixed(2)
  });
}
```

};

const addResistor = (type) => {
if (type === ‘series’) {
setSeriesResistors([…seriesResistors, ‘’]);
} else if (type === ‘parallel’) {
setParallelResistors([…parallelResistors, ‘’]);
} else if (type === ‘mixed’) {
setMixedResistors([…mixedResistors, ‘’]);
}
};

const updateResistor = (type, index, value) => {
if (type === ‘series’) {
const newResistors = […seriesResistors];
newResistors[index] = value;
setSeriesResistors(newResistors);
} else if (type === ‘parallel’) {
const newResistors = […parallelResistors];
newResistors[index] = value;
setParallelResistors(newResistors);
} else if (type === ‘mixed’) {
const newResistors = […mixedResistors];
newResistors[index] = value;
setMixedResistors(newResistors);
}
};

return (
<div className="min-h-screen bg-gray-900 p-2 sm:p-4 md:p-6">
<div className="max-w-2xl mx-auto bg-white rounded-xl sm:rounded-2xl shadow-2xl overflow-hidden">
{/* 标题 */}
<div className="bg-gradient-to-r from-green-500 to-green-600 p-4 sm:p-6">
<div className="flex items-center gap-2 sm:gap-3">
<Calculator className=“text-white flex-shrink-0” size={window.innerWidth < 640 ? 24 : 32} />
<h1 className="text-lg sm:text-2xl font-bold text-white">电路计算工具</h1>
</div>
</div>

```
    <div className="p-3 sm:p-6">
      {/* 计算模式说明 */}
      <div className="bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6">
        <h2 className="font-bold text-green-800 mb-2 sm:mb-3 text-sm sm:text-base">计算模式：</h2>
        <div className="space-y-1 sm:space-y-2 text-xs sm:text-sm text-green-700">
          <p>1. 基本计算：已知电压(V)、电流(I)、功率因数(cosφ)、频率(f)</p>
          <p>2. 串联计算：计算多个电阻串联后的总阻值</p>
          <p>3. 并联计算：计算多个电阻并联后的总阻值</p>
          <p>4. 混合计算：计算串并联混合电路的总阻值</p>
        </div>
      </div>

      {/* 模式选择按钮 */}
      <div className="grid grid-cols-2 gap-2 sm:gap-3 mb-4 sm:mb-6">
        <button
          onClick={() => { setMode('basic'); setResult(null); }}
          className={`py-2 sm:py-3 px-2 sm:px-4 rounded-lg font-medium transition-all text-sm sm:text-base ${
            mode === 'basic' 
              ? 'bg-green-500 text-white shadow-lg' 
              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
          }`}
        >
          基本计算
        </button>
        <button
          onClick={() => { setMode('series'); setResult(null); }}
          className={`py-2 sm:py-3 px-2 sm:px-4 rounded-lg font-medium transition-all text-sm sm:text-base ${
            mode === 'series' 
              ? 'bg-green-500 text-white shadow-lg' 
              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
          }`}
        >
          串联计算
        </button>
        <button
          onClick={() => { setMode('parallel'); setResult(null); }}
          className={`py-2 sm:py-3 px-2 sm:px-4 rounded-lg font-medium transition-all text-sm sm:text-base ${
            mode === 'parallel' 
              ? 'bg-green-500 text-white shadow-lg' 
              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
          }`}
        >
          并联计算
        </button>
        <button
          onClick={() => { setMode('mixed'); setResult(null); }}
          className={`py-2 sm:py-3 px-2 sm:px-4 rounded-lg font-medium transition-all text-sm sm:text-base ${
            mode === 'mixed' 
              ? 'bg-green-500 text-white shadow-lg' 
              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
          }`}
        >
          混合计算
        </button>
      </div>

      {/* 基本计算输入 */}
      {mode === 'basic' && (
        <div className="space-y-3 sm:space-y-4">
          <div>
            <label className="block text-gray-700 font-medium mb-1 sm:mb-2 text-sm sm:text-base">电压 (V):</label>
            <input
              type="number"
              value={voltage}
              onChange={(e) => setVoltage(e.target.value)}
              placeholder="输入电压值"
              className="w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm sm:text-base"
            />
          </div>
          
          <div>
            <label className="block text-gray-700 font-medium mb-1 sm:mb-2 text-sm sm:text-base">电流 (A):</label>
            <input
              type="number"
              value={current}
              onChange={(e) => setCurrent(e.target.value)}
              placeholder="输入电流值"
              className="w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm sm:text-base"
            />
          </div>
          
          <div>
            <label className="block text-gray-700 font-medium mb-1 sm:mb-2 text-sm sm:text-base">功率因数 (cosφ):</label>
            <input
              type="number"
              step="0.01"
              value={powerFactor}
              onChange={(e) => setPowerFactor(e.target.value)}
              placeholder="输入功率因数"
              className="w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm sm:text-base"
            />
          </div>
          
          <div>
            <label className="block text-gray-700 font-medium mb-1 sm:mb-2 text-sm sm:text-base">频率 (Hz):</label>
            <input
              type="number"
              value={frequency}
              onChange={(e) => setFrequency(e.target.value)}
              className="w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm sm:text-base"
            />
          </div>
        </div>
      )}

      {/* 串联计算输入 */}
      {mode === 'series' && (
        <div className="space-y-3 sm:space-y-4">
          <label className="block text-gray-700 font-medium mb-1 sm:mb-2 text-sm sm:text-base">电阻值 (Ω):</label>
          {seriesResistors.map((resistor, index) => (
            <input
              key={index}
              type="number"
              value={resistor}
              onChange={(e) => updateResistor('series', index, e.target.value)}
              placeholder={`电阻 ${index + 1}`}
              className="w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent mb-2 text-sm sm:text-base"
            />
          ))}
          <button
            onClick={() => addResistor('series')}
            className="w-full py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all text-sm sm:text-base"
          >
            + 添加电阻
          </button>
        </div>
      )}

      {/* 并联计算输入 */}
      {mode === 'parallel' && (
        <div className="space-y-3 sm:space-y-4">
          <label className="block text-gray-700 font-medium mb-1 sm:mb-2 text-sm sm:text-base">电阻值 (Ω):</label>
          {parallelResistors.map((resistor, index) => (
            <input
              key={index}
              type="number"
              value={resistor}
              onChange={(e) => updateResistor('parallel', index, e.target.value)}
              placeholder={`电阻 ${index + 1}`}
              className="w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent mb-2 text-sm sm:text-base"
            />
          ))}
          <button
            onClick={() => addResistor('parallel')}
            className="w-full py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all text-sm sm:text-base"
          >
            + 添加电阻
          </button>
        </div>
      )}

      {/* 混合计算输入 */}
      {mode === 'mixed' && (
        <div className="space-y-3 sm:space-y-4">
          <label className="block text-gray-700 font-medium mb-1 sm:mb-2 text-sm sm:text-base">电阻值 (Ω):</label>
          <p className="text-xs sm:text-sm text-gray-600 mb-2">提示：前半部分串联，后半部分并联</p>
          {mixedResistors.map((resistor, index) => (
            <input
              key={index}
              type="number"
              value={resistor}
              onChange={(e) => updateResistor('mixed', index, e.target.value)}
              placeholder={`电阻 ${index + 1}`}
              className="w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent mb-2 text-sm sm:text-base"
            />
          ))}
          <button
            onClick={() => addResistor('mixed')}
            className="w-full py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all text-sm sm:text-base"
          >
            + 添加电阻
          </button>
        </div>
      )}

      {/* 计算按钮 */}
      <button
        onClick={calculate}
        className="w-full mt-4 sm:mt-6 py-3 sm:py-4 bg-green-500 text-white rounded-lg font-bold text-base sm:text-lg hover:bg-green-600 transition-all shadow-lg hover:shadow-xl"
      >
        计算
      </button>

      {/* 结果显示 */}
      {result && (
        <div className="mt-4 sm:mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4 sm:p-6">
          <h3 className="font-bold text-blue-800 mb-3 sm:mb-4 text-base sm:text-lg">计算结果：</h3>
          {mode === 'basic' && (
            <div className="space-y-2 sm:space-y-3 text-blue-700">
              <p className="text-sm sm:text-lg"><span className="font-semibold">电感 L:</span> {result.inductance} mH</p>
              <p className="text-sm sm:text-lg"><span className="font-semibold">电阻 R:</span> {result.resistance} Ω</p>
              <p className="text-sm sm:text-lg"><span className="font-semibold">阻抗 Z:</span> {result.impedance} Ω</p>
              <p className="text-sm sm:text-lg"><span className="font-semibold">电抗 X:</span> {result.reactance} Ω</p>
            </div>
          )}
          {(mode === 'series' || mode === 'parallel') && (
            <div className="space-y-2 text-blue-700 text-sm sm:text-base">
              <p>总电阻: {result.totalResistance} Ω</p>
              <p>电阻数量: {result.count} 个</p>
            </div>
          )}
          {mode === 'mixed' && (
            <div className="space-y-2 text-blue-700 text-sm sm:text-base">
              <p>总电阻: {result.totalResistance} Ω</p>
              <p>串联部分: {result.seriesTotal} Ω</p>
              <p>并联部分: {result.parallelTotal} Ω</p>
            </div>
          )}
        </div>
      )}
    </div>
  </div>
</div>
```

);
}
